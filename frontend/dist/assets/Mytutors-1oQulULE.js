import{r as a,u as j,o as x,j as e,B as y,M as v,T as b,R as N,d as S,v as p,S as C,y as E,F as k}from"./index-tJXQ2hjm.js";function T({name:h,bio:d,profile:t,userID:o,tutorRatings:u,setCurrentRating:g,setRateTutuorId:s}){const[l,n]=a.useState(""),f=j(),c=i=>{n(i)};return a.useEffect(()=>{(async function(){if(l)try{await x.post("/chat",{userId:l},{withCredentials:!0}),n(""),f("/student/chat")}catch(i){console.log(i)}})()},[l,f]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"w-64 flex flex-col relative text-center items-center justify-center h-fit ring-my-ring ring-1 rounded-lg p-3 bg-my-bg-dark text-white",children:[e.jsx("img",{src:t||"https://www.seekpng.com/png/detail/115-1150456_avatar-generic-avatar.png",alt:"",className:"w-28 rounded-full mt-3 border-2 border-violet-700"}),e.jsx("h1",{className:"font-bold text-3xl",children:h}),e.jsx("small",{children:d}),e.jsx("button",{onClick:()=>{c(o)},className:"bg-primary font-bold text-white w-full rounded-md my-2",children:"CHAT"}),e.jsx("span",{onClick:()=>{g(u.find(i=>i.tutorId===o)),s(o)},className:"text-blue-600 cursor-pointer hover:underline absolute top-2 right-4",children:"Rate?"})]})})}const F=S({palette:{mode:"dark"}});function M({openModal:h,setOpenModal:d,currentRating:t,rateTutorId:o,setRateTutuorId:u,setUpdated:g}){const[s,l]=a.useState({rating:t?t.rating:0,review:t?t.review:""}),[n,f]=a.useState({review:"",rating:""}),[c,i]=a.useState(!1);a.useEffect(()=>{l({...s,rating:t?t.rating:0,review:t?t.review:""})},[t]);const r=m=>{m.preventDefault(),f({review:p("review",s.review),rating:p("required",s.rating)}),i(!0)};return a.useEffect(()=>{(async function(){if(c&&!n.rating&&!n.review&&o&&s.rating&&s.review)try{const{data:m}=await x.post("/rating",{rating:s.rating,review:s.review,_id:o},{withCredentials:!0});m.success&&(y.success("rated tutor successfuly!"),g(w=>!w),u(""),d(!1),i(!1))}catch{i(!1)}})()},[n,s,c,o,d,i,u,g]),e.jsxs(v,{show:h,onClose:()=>{u(""),l({...s,rating:t?t.rating:0,review:t?t.review:""}),d(!1)},children:[e.jsx(v.Header,{className:"ring-1 ring-[#4d2389] bg-[#110d17]  rounded-t-md",children:e.jsx("h1",{className:"text-white",children:"Rate this tutor"})}),e.jsxs(v.Body,{className:"ring-1 ring-[#4d2389] flex space-y-6 flex-col bg-[#110d17] rounded-b-md",children:[n.rating&&e.jsx("small",{className:"text-red-600",children:n.rating}),e.jsx(b,{theme:F,children:e.jsx(N,{name:"size-large",value:s.rating,size:"large",onChange:(m,w)=>{l({...s,rating:w})}})}),n.review&&e.jsx("small",{className:"text-red-600",children:n.review}),e.jsx("input",{type:"text",value:s.review,onChange:m=>{l({...s,review:m.target.value})},className:"bg-my-input rounded-md ring-1 outline-none border-0 text-gray-300"}),e.jsx("button",{onClick:r,className:"bg-primary  text-white py-2 rounded-lg hover:bg-my-ring",children:"submit"})]})]})}function B(){const[h,d]=a.useState([]),[t,o]=a.useState([]),[u,g]=a.useState(!1),[s,l]=a.useState(!1),[n,f]=a.useState({rating:null,review:"",userId:""}),[c,i]=a.useState("");return a.useEffect(()=>{c&&g(!0)},[c]),a.useEffect(()=>{(async function(){try{const{data:r}=await x.get("/student/mytutors",{withCredentials:!0});d(r.teachers)}catch(r){console.log(r)}})()},[]),a.useEffect(()=>{(async function(){try{const{data:r}=await x.get("/rating",{withCredentials:!0});o(r.ratings)}catch(r){console.log(r)}})()},[s]),e.jsxs(e.Fragment,{children:[e.jsx(M,{currentRating:n,openModal:u,setOpenModal:g,rateTutorId:c,setRateTutuorId:i,setUpdated:l}),e.jsx(C,{}),e.jsxs("div",{className:"flex flex-wrap md:px-10 md:pt-10 md:pb-44  p-4 gap-10 bg-secondary",children:[e.jsx(E,{}),e.jsx("div",{className:"flex flex-wrap gap-4",children:h.length>0&&h.map(r=>e.jsx(T,{setRateTutuorId:i,tutorRatings:t,setCurrentRating:f,bio:r.bio,name:r.name,userID:r.userID,profile:r.profile}))})]}),e.jsx(k,{})]})}export{B as default};
