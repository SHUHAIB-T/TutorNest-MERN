import{r as a,E as N,G as v,H as C,I as S,o as p,B as g,j as e,M as u,L as U}from"./index-gFtRcUh9.js";import{N as E}from"./NavBar-oaf12bXh.js";import{D as T}from"./DocumentTable-Dnddlit4.js";import{d as k}from"./ChevronLeft-ERbaoIke.js";import"./Cancel-f8ok8c79.js";import"./Paper-wJdYsrnY.js";function B({openModal:d,setOpenModal:o,setUploaded:i}){const[s,m]=a.useState({image:"",name:""}),[n,l]=a.useState(null),[r,f]=a.useState(""),[x,h]=a.useState(!1),j=t=>{if(t.target.files){const c=t.target.files[0];l(c)}},w=t=>{const{value:c}=t.target;m({...s,name:c})},b=t=>{t.preventDefault(),!n||!s.name?f("some field are missing"):(f(""),h(!0))};return a.useEffect(()=>{(async function(){if(x&&!r&&s)try{if(n){const t=new Date().getTime()+n.name,c=N(v,"documets/"+t);if(await C(c,n)){const y=await S(c);await p.post("/tutor/uploadDoc",{image:y,name:s.name},{withCredentials:!0})&&(m({name:"",image:""}),g.success("Document Uploaded"),o(!1),i(D=>!D),h(!1))}}}catch(t){console.log(t)}})()},[r,s,o,i,n,x]),e.jsx(e.Fragment,{children:e.jsxs(u,{show:d,size:"md",onClose:()=>o(!1),popup:!0,children:[e.jsx(u.Header,{}),e.jsxs(u.Body,{children:[e.jsxs("div",{className:"text-center",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:j}),e.jsx("div",{className:"flex justify-center w-full mt-3 rounded bg-red-100",children:r&&e.jsx("small",{className:" text-red-600",children:r})}),e.jsxs("div",{className:" w-full flex items-start mt-5 flex-col",children:[e.jsx("label",{htmlFor:"text",children:"Name of the Document"}),e.jsx("input",{type:"text",value:s.name,onChange:w,className:"w-full rounded-md",placeholder:"Enter the name of the document"})]})]}),e.jsx("button",{onClick:b,className:"w-full rounded-md text-white bg-primary font-bold py-2 mt-3",children:"UPLOAD"})]})]})})}function z(){const[d,o]=a.useState(!1),[i,s]=a.useState([]),[m,n]=a.useState(!1);return a.useEffect(()=>{(async function(){try{const l=await p.get("/tutor/documents",{withCredentials:!0});l&&s(l.data.documents)}catch(l){const r=l;g.error(r.message)}})()},[m]),e.jsxs(e.Fragment,{children:[e.jsx(B,{openModal:d,setUploaded:n,setOpenModal:o}),e.jsx(E,{role:"TUTOR"}),e.jsxs("div",{className:"flex w-full flex-col h-[100vh] items-center bg-secondary",children:[e.jsx("h1",{className:"font-bold text-5xl text-white mt-10",children:"My Documents"}),e.jsxs("div",{className:"w-[80%] mt-3 flex justify-between",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs(U,{to:"/",className:"font-bold text-white",children:[e.jsx(k,{className:"mb-1"})," Back"]})}),e.jsx("button",{className:"bg-primary px-5 py-2 rounded-md text-white font-bold",onClick:()=>o(!0),children:"Upload Document"})]}),e.jsx(T,{role:"TUTOR",documents:i,setDocuments:s})]})]})}export{z as default};
