import{r as a,J as D,K as v,N as C,O as S,a as j,B as f,j as e,M as u,k as U}from"./index-4mQrzorV.js";import{N as E}from"./NavBar-Dk95Zm8i.js";import{D as k}from"./DocumentTable-Epymx1Hm.js";import{d as T}from"./ChevronLeft-2_ZgKlWi.js";import"./Cancel-bRrxsMnd.js";import"./Paper-rGG8zCiV.js";function B({openModal:d,setOpenModal:o,setUploaded:i}){const[t,m]=a.useState({image:"",name:""}),[n,r]=a.useState(null),[l,x]=a.useState(""),[h,p]=a.useState(!1),g=s=>{if(s.target.files){const c=s.target.files[0];r(c)}},w=s=>{const{value:c}=s.target;m({...t,name:c})},N=s=>{s.preventDefault(),!n||!t.name?x("some field are missing"):(x(""),p(!0))};return a.useEffect(()=>{(async function(){if(h&&!l&&t)try{if(n){const s=new Date().getTime()+n.name,c=D(v,"documets/"+s);if(await C(c,n)){const b=await S(c);await j.post("/tutor/uploadDoc",{image:b,name:t.name},{withCredentials:!0})&&(m({name:"",image:""}),f.success("Document Uploaded"),o(!1),i(y=>!y),p(!1))}}}catch{f.error("Error")}})()},[l,t,o,i,n,h]),e.jsx(e.Fragment,{children:e.jsxs(u,{show:d,size:"md",onClose:()=>o(!1),popup:!0,children:[e.jsx(u.Header,{}),e.jsxs(u.Body,{children:[e.jsxs("div",{className:"text-center",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:g}),e.jsx("div",{className:"flex justify-center w-full mt-3 rounded bg-red-100",children:l&&e.jsx("small",{className:" text-red-600",children:l})}),e.jsxs("div",{className:" w-full flex items-start mt-5 flex-col",children:[e.jsx("label",{htmlFor:"text",children:"Name of the Document"}),e.jsx("input",{type:"text",value:t.name,onChange:w,className:"w-full rounded-md",placeholder:"Enter the name of the document"})]})]}),e.jsx("button",{onClick:N,className:"w-full rounded-md text-white bg-primary font-bold py-2 mt-3",children:"UPLOAD"})]})]})})}function H(){const[d,o]=a.useState(!1),[i,t]=a.useState([]),[m,n]=a.useState(!1);return a.useEffect(()=>{(async function(){try{const r=await j.get("/tutor/documents",{withCredentials:!0});r&&t(r.data.documents)}catch(r){const l=r;f.error(l.message)}})()},[m]),e.jsxs(e.Fragment,{children:[e.jsx(B,{openModal:d,setUploaded:n,setOpenModal:o}),e.jsx(E,{role:"TUTOR"}),e.jsxs("div",{className:"flex w-full flex-col h-[100vh] items-center bg-secondary",children:[e.jsx("h1",{className:"font-bold text-5xl text-white mt-10",children:"My Documents"}),e.jsxs("div",{className:"w-[80%] mt-3 flex justify-between",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs(U,{to:"/",className:"font-bold text-white",children:[e.jsx(T,{className:"mb-1"})," Back"]})}),e.jsx("button",{className:"bg-primary px-5 py-2 rounded-md text-white font-bold",onClick:()=>o(!0),children:"Upload Document"})]}),e.jsx(k,{role:"TUTOR",documents:i,setDocuments:t})]})]})}export{H as default};
